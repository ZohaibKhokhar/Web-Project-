@{
    Layout = "Layout2";
}

<main>
    <div class="container mt-5">
        <h2 class="my-4">Filter Items by Price Range</h2>
        <form id="priceRangeForm">
            <div class="form-group">
                <label for="minPrice">Minimum Price:</label>
                <input type="number" id="minPrice" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="maxPrice">Maximum Price:</label>
                <input type="number" id="maxPrice" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-primary my-5">Fetch Products</button>
        </form>
        <div id="products-container" class="mt-3"></div>
    </div>
</main>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('#priceRangeForm').submit(function (e) {
            e.preventDefault();

            var minPrice = $('#minPrice').val();
            var maxPrice = $('#maxPrice').val();

            $.ajax({
                url: '@Url.Action("GetProductsByPriceRange", "Home")',
                type: 'GET',
                data: { minPrice: minPrice, maxPrice: maxPrice },
                success: function (response) {
                    var productsHtml = '<ul class="list-group">';
                    response.forEach(function (product) {
                        productsHtml += '<li class="list-group-item">';
                        productsHtml += '<h5>' + (product.PName || 'Unknown Product') + '</h5>';
                        productsHtml += '<p>Price: $' + (product.Price ? product.Price.toFixed(2) : 'N/A') + '</p>';
                        productsHtml += '<p>Discounted Price: $' + (product.DiscountedPrice ? product.DiscountedPrice.toFixed(2) : 'N/A') + '</p>';
                        productsHtml += '<p>Quantity: ' + (product.Quantity != null ? product.Quantity : 'N/A') + '</p>';
                        productsHtml += '<img src="' + (product.ImageUrl || '/images/about3.png') + '" alt="' + (product.PName || 'Product Image') + '" class="img-thumbnail" style="max-width: 100px;">';
                        productsHtml += '</li>';
                    });
                    productsHtml += '</ul>';
                    $('#products-container').html(productsHtml);
                },
                error: function () {
                    $('#products-container').html('<div class="alert alert-danger">An error occurred while fetching products.</div>');
                }
            });
        });
    });
</script>
